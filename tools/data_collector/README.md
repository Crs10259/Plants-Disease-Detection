# 植物病害数据集制作工具

这个工具用于制作植物病害识别所需的数据集，支持两种数据来源：
1. 导入用户本地数据
2. 从互联网自动收集图像数据

## 功能特点

- 基于PyQt6的现代用户界面
- 灵活的数据分割配置（训练集/验证集/测试集）
- 支持从多种在线数据源收集图像（Google, Bing, 百度, Flickr等）
- 自动生成数据集标签文件
- 图像质量过滤与去重功能

## 安装依赖

**Windows用户快捷安装**：
直接运行`install.bat`批处理文件安装所有依赖：
```
install.bat
```

**手动安装**：
```bash
pip install -r requirements.txt
```

## 使用方法

**Windows用户快捷启动**：
直接运行`run_tool.bat`批处理文件启动工具：
```
run_tool.bat
```

**手动启动**：
```bash
python start.py
```

**使用新的入口点**：
```bash
python main.py
```

**命令行模式**：
工具也支持命令行操作，不启动图形界面：
```bash
# 从本地目录导入数据
python app.py --headless --source-dir /path/to/source --output-dir /path/to/output

# 从网络收集数据（默认使用Google、Bing和百度）
python app.py --headless --search-terms "玉米叶斑病,水稻稻瘟病" --output-dir /path/to/output

# 启用调试日志
python app.py --debug
```

### 导入用户数据

1. 选择"导入用户数据"选项卡
2. 浏览并选择包含图像数据的源目录
   - 源目录应该包含按类别组织的子目录
   - 例如: `/source_data/玉米叶斑病/`, `/source_data/水稻稻瘟病/` 等
3. 点击"扫描目录"以加载类别信息
4. 设置输出目录和数据集分割比例
5. 点击"生成数据集"

### 在线数据收集

1. 选择"在线数据收集"选项卡
2. 输入要搜索的植物病害名称，每行一个
3. 选择要使用的数据源（Google、Bing等）
4. 设置每个类别要收集的图像数量
5. 配置输出选项
6. 点击"生成数据集"

## 输出格式

生成的数据集将按以下结构组织:

```
output_dir/
├── train/              # 训练集
│   ├── 0/              # 类别0
│   ├── 1/              # 类别1
│   └── ...
├── val/                # 验证集
│   ├── 0/
│   ├── 1/
│   └── ...
├── test/               # 测试集
│   ├── 0/
│   ├── 1/
│   └── ...
└── labels.json         # 类别标签映射
```

`labels.json` 包含类别ID到名称的映射，例如:

```json
{
  "0": {
    "id": 0,
    "name": "玉米叶斑病"
  },
  "1": {
    "id": 1,
    "name": "水稻稻瘟病"
  }
}
```

## 注意事项

- 在线数据收集功能需要遵守数据源的使用条款和版权规定
- 收集到的图像可能包含不相关内容，建议在使用前进行手动验证
- 建议使用质量过滤和去重功能以提高数据集质量

## 故障排除

如果遇到问题：
1. 确保已安装所有依赖项：运行`install.bat`或手动安装
2. 检查logs目录下的app.log文件以查看详细错误信息
3. 如果是模块导入错误，确保从`start.py`启动程序

## 开发者信息

此工具作为植物病害检测项目的辅助工具开发，用于简化数据集制作过程。 